<!DOCTYPE html>
<html>
<head>
    <title>ReadyBrainAI Coach</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .chat-container {
            max-width: 700px;
            margin: 40px auto;
            background: white;
            padding: 20px;
            border-radius: 14px;
            box-shadow: 0 0 10px #ccc;
        }
        .message {
            margin: 12px 0;
            padding: 12px 15px;
            border-radius: 10px;
            white-space: pre-wrap;
        }
        .you { background: #e3ffe4; }
        .ai { background: #f0f0f0; }

        #preview {
            max-width: 200px;
            display: none;
            margin-top: 10px;
            border-radius: 8px;
        }
        .input-area {
            margin-top: 20px;
        }
        button {
            padding: 10px 18px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        button:hover { background: #005fd1; }
    </style>
</head>

<body>
    <div class="chat-container">
        <h2>ReadyBrainAI â€“ Interview Coach</h2>

        <div id="chat"></div>

        <img id="preview" />

        <div class="input-area">
            <textarea id="message" rows="3" style="width:100%;"></textarea>

            <input type="file" id="image" accept="image/*"
                   onchange="showPreview(event)" />

            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

<script>
function showPreview(event) {
    const img = document.getElementById("preview");
    img.style.display = "block";
    img.src = URL.createObjectURL(event.target.files[0]);
}

async function sendMessage() {
    const msg = document.getElementById("message").value;
    const imageFile = document.getElementById("image").files[0];

    let form = new FormData();
    form.append("message", msg);
    if (imageFile) {
        form.append("image", imageFile);
    }

    // Add user message to UI
    addMessage(msg, "you");

    // Clear input
    document.getElementById("message").value = "";
    document.getElementById("image").value = "";
    document.getElementById("preview").style.display = "none";

    const response = await fetch("/ask", {
        method: "POST",
        body: form
    });

    const data = await response.json();
    addMessage(data.reply, "ai");
}

function addMessage(text, who) {
    const chat = document.getElementById("chat");
    const div = document.createElement("div");
    div.className = "message " + who;
    div.innerText = text;
    chat.appendChild(div);

    // Auto scroll to bottom
    chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>

